<% include ./partials/_header %>

<div class="pinnednote activity">

  <div class="name"><%= results.resource.title %></div>
  <span class="badge badge-warning resource-details"><a href="/topic/<%= results.topic.id %>"><%= results.topic.name %></a></span>

</div>
<div class="pinned-content">
  <p><%= results.resource.description %></p>

  <% if (typeof userID !== "undefined") { %>

    <br>LIKES: <%= results.likes %>
    <br>RATING: <%= results.rating %> (<%= results.numUsers %> users)

    <form method=POST action='/resource/<%= results.resource.id %>/like'>
        <button style="margin-left: 50%;" type="submit" name="liked">
          <%= (results.userReaction && results.userReaction.liked) ? "Unlike" : "Like" %>
        </button>
    </form>
    <form method=POST action='/resource/<%= results.resource.id %>/rate'>
      <select style="float:right;" type='submit' onchange="this.form.submit()"  name="rating">
          <% let rating = (results.userReaction && results.userReaction.rating) || 0 %>
          <option <%= (rating === 0) && "selected" %> disabled></option>
          <option <%= (rating === 1) && "selected" %> >1</option>
          <option <%= (rating === 2) && "selected" %> >2</option>
          <option <%= (rating === 3) && "selected" %> >3</option>
          <option <%= (rating === 4) && "selected" %> >4</option>
          <option <%= (rating === 5) && "selected" %> >5</option>

        </select>
    </form>

    <form method=POST action='/resource/<%= results.resource.id %>/comment'>
      <textarea name="comment">add comment</textarea>
      <br><button type="submit">Submit Comment</button>
    </form>

    <% if (results.comments) { %>

      <%= JSON.stringify(results.comments) %>

    <% } %>

  <% } %>

</div>

<% include ./partials/_footer %>
